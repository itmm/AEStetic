<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <title>AEStetic</title> <meta name="viewport" content="initial-scale=1, maximum-scale=1"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-status-bar-style" content="black"> <meta name="format-detection" content="telephone=no"> <style>.hidden{ display:none;}.bytes, .editable, .referable{ font-family:monospace;padding:8px 15px;background-color:#fff;}.bytes{ color:#888;}.editable{ color:#008;background-color:#ddf;}.referable{ color:#008;}.bytes div, .editable div, .referable div{ display:inline-block;padding:0 12px 0 0;}.active-1{ background-color:rgba(255, 0, 0, 0.5);}.active-2{ background-color:rgba(255, 0, 0, 0.25);}.active-3{ background-color:rgba(255, 0, 0, 0.125);}.active-4{ background-color:rgba(255, 0, 0, 0.115);}.active-5{ background-color:rgba(255, 0, 0, 0.105);}.active-6{ background-color:rgba(255, 0, 0, 0.095);}.active-7{ background-color:rgba(255, 0, 0, 0.085);}.active-8{ background-color:rgba(255, 0, 0, 0.075);}.active-9{ background-color:rgba(255, 0, 0, 0.065);}.active-10{ background-color:rgba(255, 0, 0, 0.055);}.disabled{ color:rgba(0, 0, 0, .2) !important;pointer-events:none;}*{ box-sizing:border-box;}p{ margin-top:0;margin-bottom:10px;font-size:14px;color:#777;}body{ font-family:"Helvetica Neue", Helvetica, sans-serif;font-size:17px;line-height:21px;color:#000;background-color:#fff;}h1{ position:fixed;top:0;right:0;left:0;z-index:10;height:44px;background-color:#fff;border-bottom:solid 1px #ddd;display:block;width:100%;padding:0 10px;margin:0 -10px;font-size:17px;font-weight:500;line-height:44px;text-align:center;}.content{ position:absolute;top:0;right:0;left:0;padding-top:44px;}.content-padded{ margin:10px 15px;}.error-overlay{ position:absolute;z-index:20;top:50%;left:50%;transform:translateY(-50%);transform:translateX(-50%);background-color:#600;color:#f00;border:solid 3px #f00;border-radius:6px;}div#calc{ position:absolute;z-index:20;top:0;left:0;background-color:#fff;color:#444;border:solid 1px #888;border-radius:6px;padding:6px;}div#calc p{ margin-bottom:0;}.error-overlay > h2{ height:44px;background-color:#600;border-bottom:solid 1px #f00;padding:0 10px;margin:0;font-size:17px;font-weight:500;line-height:44px;text-align:center;}.error-overlay > p{ margin:0;padding:6px 10px;color:#fff;}ul{ padding-left:0;margin-top:0;margin-bottom:15px;list-style:none;border-bottom:1px solid #ddd;}li{ border-top:1px solid #ddd;padding:11px 65px 11px 15px;}li.sub{ border-top:0;}.header{ padding-top:6px;padding-bottom:6px;padding-left:15px;margin-top:-1px;margin-left:0;font-weight:500;color:#999;background-color:#fafafa;border-top:1px solid #ddd;}.card{ overflow:hidden;background-color:#fff;margin:0 10px 10px 10px;border:1px solid #ddd;border-radius:6px;}.card ul{ margin-bottom:0;border-top:0;border-bottom:0;}.card ul li:first-child{ border-top:0;}li > a{ position:relative;display:block;padding:inherit;margin:-11px -65px -11px -15px;color:#008;text-decoration:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:-moz-none;-o-user-select:none;user-select:none;}li.header > a{ padding:inherit;margin:-6px -65px -6px -15px;}li > a > span.icon-expand, li > a > span.icon-collapse, li > a > span.right{ position:absolute;right:15px;top:50%;transform:translateY(-50%);font-size:21px;}span.icon-expand:before{ content:"\27e9";}span.icon-collapse:before{ content:"\27e8";}span.badge-aes256, span.badge-aes192, span.badge-aes128, span.badge-rijndael, span.badge-unknown{ display:inline-block;padding:2px 9px 3px;font-size:12px;line-height:1;border-radius:100px;margin-right:6px;transform:translateY(-2px);}span.badge-aes256, span.badge-aes192, span.badge-aes128{ color:#060;background-color:rgba(0, 255, 0, 0.15);border:solid 1px #060;}span.badge-rijndael{ color:#550;background-color:rgba(255, 255, 0, 0.15);border:solid 1px #550;}span.badge-unknown{ color:#600;background-color:rgba(255, 0, 0, 0.15);border:solid 1px #600;}span.badge-aes256:before{ content:"AES-256";}span.badge-aes192:before{ content:"AES-192";}span.badge-aes128:before{ content:"AES-128";}span.badge-rijndael:before{ content:"Rijndael";}span.badge-unknown:before{ content:"Non-Standard Configuration";}#connections{ position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;}</style></meta></meta></meta></meta></meta></head> <body> <h1>AEStetic</h1> <div id="no-javascript" class="error-overlay"> <h2>No JavaScript active</h2> <p> Please activate Javascript to use this Web-App. </p> </div> <script type="text/javascript">document.getElementById("no-javascript").classList.add("hidden");</script> <div id="main" class="content hidden"> <div class="content-padded"> <p>Inspect the encryption of AES step by step. Tap on each byte to see the bytes it depends on. </p> </div> <ul> <li class="header"><a id="toggle-configuration" href="">Configuration <span class="right"><span id="badge" class="badge-aes256"/> <span id="conf-label" class="icon-collapse"/></span></a></li> <li id="testvectors-toggler"><a id="toggle-testvectors" href="#">AES Variants and Test Vectors<span class="icon-expand"/></a></li> <li class="hidden sub" id="testvectors"> <div class="card"><ul id="testvectors-container"/></div> </li> <li id="rounds-toggler"><a id="toggle-rounds" href="#">Rounds: <span id="rounds-label"/><span class="icon-expand"/></a></li> <li class="hidden sub" id="rounds-config"> <div class="card"> <ul> <li><a id="dec-rounds" href="#">less rounds</a></li> <li><a id="inc-rounds" href="#">more rounds</a></li> </ul> </div> </li> <li id="sbox-toggler"><a id="toggle-sbox" href="#">S-Box <span class="icon-expand"/></a></li> <li class="editable hidden sub" id="sbox"/> <li id="permute-toggler"><a id="toggle-permute" href="#">Permutation <span class="icon-expand"/></a></li> <li class="editable hidden sub" id="permute"/> <li class="header"><a id="toggle-key" href="#">Key<span class="icon-collapse"/></a></li> <li class="editable" id="key"/> <li id="expanded-key-toggler"><a id="toggle-expanded-key" href="#">Expanded Key <span class="icon-expand"/></a></li> <li class="referable hidden sub" id="expanded-key"/> <li class="header"><a id="toggle-input" href="#">Input<span class="icon-collapse"/></a></li> <li class="editable" id="input"/> <li class="header" id="rounds"><a id="toggle-enc-rounds" href="#">Encoding Rounds <span id="toggle-enc-label" class="icon-collapse"/></a></li> <li class="header" id="rounds-end"><a id="toggle-encoded" href="#">Encoded <span class="icon-collapse"/></a></li> <li class="referable" id="output"/> <li class="header" id="reference"><a id="toggle-reference" href="#">Reference <span class="icon-collapse"/></a></li> <li class="bytes" id="reference-bytes"/> <li class="header" id="decode-rounds"><a id="toggle-dec-rounds" href="#">Decoding Rounds <span id="toggle-dec-label" class="icon-collapse"/></a></li> <li class="header" id="decode-rounds-end"><a id="toggle-decoded" href="#">Decoded <span class="icon-collapse"/></a></li> <li class="referable" id="decoded"/> </ul> <div id="calc" class="hidden">Calculation</div> <svg id="connections" xmlns="http://www.w3.org/2000/svg" version="1.1" baseProfile="full" width="100%" height="100%"> </svg> </div> <script type="text/javascript">document.getElementById("main").classList.remove("hidden");</script> <script>window.addEventListener("load",function(){"use strict";function e(e){return document.getElementById(e)}function n(e,n){e&&e.classList&&e.classList.add(n)}function t(e,n){e&&e.classList&&e.classList.remove(n)}function r(e,r,o){o?n(e,r):t(e,r)}function o(e,t,r){var o=document.createElement(e);return t&&o.setAttribute("id",t),$.each(r,function(e){n(o,e)}),o}function i(e){return document.createTextNode(e)}function u(){return i(" ")}function a(e,n,t){return t&&e.appendChild(u()),e.appendChild(n),e}function d(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)}function s(e,n){for(var t=e.parentNode;;){var r=e.nextSibling;if(r==n)break;t.removeChild(r)}}function c(e,n){return d(e),e.appendChild(i(n)),e}function l(e){return c(o("p"),e)}function p(e){return $.map(e.slice(),l)}function f(r,o,i,u){if(r.length&&!(i>10)){var a=[],d="active-"+i;$.each(r,function(r){o.indexOf(r)<0&&($.each(_[r],function(e){a.push(e)}),o.push(r)),u?n(e(r),d):t(e(r),d)}),f(a,o,i+1,u)}}function h(){var r=e("calc");if(ne&&r.firstChild){var o=e(ne).getBoundingClientRect();o.width||o.height||(f([ne],[],1,!1),ne=null,d(r),x()),calc.style.left=o.left+window.scrollX+o.width+4+"px",calc.style.top=o.top+window.scrollY+o.height+4+"px",t(r,"hidden")}else n(r,"hidden")}function v(e){return{x:e.left+e.width/2+window.scrollX,y:e.top+e.height/2+window.scrollY}}function b(e,n){var t=e.getBoundingClientRect(),r=n.getBoundingClientRect();if(!(t.width&&t.height&&r.width&&r.height))return null;var o,i,u,a,d=v(t),s=v(r);if(Math.abs(d.x-s.x)>Math.abs(d.y-s.y)){var c=(s.y-d.y)/(s.x-d.x);d.x<s.x?(o=t.right+1+window.scrollX,u=r.left-1+window.scrollX):(o=t.left-1+window.scrollX,u=r.right+1+window.scrollX),i=d.y-c*(d.x-o),a=d.y-c*(d.x-u)}else{var c=(s.x-d.x)/(s.y-d.y);d.y<s.y?(i=t.bottom+1+window.scrollY,a=r.top-1+window.scrollY):(i=t.top-1+window.scrollY,a=r.bottom+1+window.scrollY),o=d.x-c*(d.y-i),u=d.x-c*(d.y-a)}var l=document.createElementNS("http://www.w3.org/2000/svg","line");return l.setAttribute("x1",o),l.setAttribute("y1",i),l.setAttribute("x2",u),l.setAttribute("y2",a),l.setAttribute("stroke","rgba(255, 0, 0, 0.3)"),l.setAttribute("stroke-width","1px"),l}function k(){var n=e("connections");if(d(n),ne){var t=e(ne);$.each(_[ne],function(r){var o=e(r),i=b(t,o);i&&n.appendChild(i)})}}function x(){h(),k()}function y(n){ne&&f([ne],[],1,!1);var t=this.getAttribute("id");if(t==ne)ne=null;else{ne=t,f([ne],[],1,!0);var r=e("calc"),o=ee[t];d(r),$.each(o,function(e){r.appendChild(e)})}x(),n.preventDefault()}function g(e,n){var t=_[e];null==t&&(t=[],_[e]=t),t.push(n)}function m(e){var n=e.toString(16);return 16>e?"0"+n:n}function S(e){return"0x"+m(e)}function w(e,n,t,r){var i=4,u=n.length;d(e);for(var s=0;u>s;s+=i){for(var l=o("div"),p=0;i>p;++p){var f=s+p,h=o("span",t+f);r&&h.addEventListener("click",y),a(l,c(h,m(n[f])),p>0)}a(e,l,s)}}function z(){if(te=!1,re=!1,oe=!1,ie=!1,ue=null,$.equals(Z.sbox,V.sbox)&&$.equals(Z.permute,V.permute)){switch(Z.key.length){case 16:Z.rounds>=10&&Z.rounds<=14&&(te=!0,re=10==Z.rounds);break;case 20:Z.rounds>=11&&Z.rounds<=14&&(te=!0);break;case 24:Z.rounds>=12&&Z.rounds<=14&&(te=!0,oe=12==Z.rounds);break;case 28:Z.rounds>=13&&Z.rounds<=14&&(te=!0);break;case 32:14==Z.rounds&&(te=!0,ie=!0)}if(ie||oe||re)for(var n=0;n<W.length;++n){var t=W[n],o=$.equals(Z.key,t.key),i=$.equals(Z.input,t.input);Z.rounds==t.rounds&&o&&i&&(ue=t)}}var u=e("badge");r(u,"badge-aes256",ie),r(u,"badge-aes192",oe),r(u,"badge-aes128",re),r(u,"badge-rijndael",te&&!(ie||oe||re)),r(u,"badge-unknown",!te)}function A(){c(e("rounds-label"),Z.rounds),r(e("dec-rounds"),"disabled",Z.rounds<=1),w(e("sbox"),Z.sbox,"sbox-",!1),w(e("permute"),Z.permute,"permute-",!1),w(e("key"),Z.key,"key-",!1),w(e("input"),Z.input,"input-",!1),z(),r(e("reference"),"hidden",null==ue),r(e("reference-bytes"),"hidden",null==ue),ue&&w(e("reference-bytes"),ue.encoded,!1)}function C(){var n=e("testvectors-container");d(n),$.each(W,function(e){var t=o("li"),r=o("a");c(r,e.name),t.appendChild(r),n.appendChild(t),r.addEventListener("click",function(n){Z.sbox=V.sbox.slice(),Z.permute=V.permute.slice(),Z.key=e.key.slice(),Z.input=e.input.slice(),Z.rounds=e.rounds,Z.blockSize=V.blockSize,Y(),n.preventDefault()})})}function L(){U=Array((Z.rounds+1)*Z.blockSize),$.each(Z.key,function(e,n){U[n]=e,_["expanded-key-"+n]=["key-"+n],ee["expanded-key-"+n]=p(["key["+n+"]"])});for(var n=1,t=0,r=Z.key.length;r<U.length;r+=4){for(var o=0;4>o;++o)U[r+o]=U[r-4+o],g("expanded-key-"+(r+o),"expanded-key-"+(r-4+o)),ee["expanded-key-"+(r+o)]=p(["cur ← "+S(U[r+o-4])+" = key["+(r+o-4)+"]"]);if(r%Z.key.length==0){var i=U[r],u=_["expanded-key-"+r],a=ee["expanded-key-"+r];for(o=0;3>o;++o)U[r+o]=U[r+o+1],_["expanded-key-"+(r+o)]=_["expanded-key-"+(r+o+1)],ee["expanded-key-"+(r+o)]=ee["expanded-key-"+(r+o+1)];U[r+3]=i,_["expanded-key-"+(r+3)]=u,ee["expanded-key-"+(r+3)]=a;for(var o=0;4>o;++o){var d=r+o;g("expanded-key-"+d,"sbox-"+U[d]),U[d]=Z.sbox[U[d]],ee["expanded-key-"+d].push(l("cur ← "+S(U[d])+" = S-Box[cur]"))}ee["expanded-key-"+r].push(l("rcon ← "+S(n)+" = 0x02 ^ "+t)),U[r]^=n,ee["expanded-key-"+r].push(l("cur ← "+S(U[r])+" = cur ⊕ rcon")),n=D(n,2),++t}else if(Z.key.length>24&&r%Z.key.length==16)for(var o=0;4>o;++o){var d=r+o;g("expanded-key-"+d,"sbox-"+U[d]),U[d]=Z.sbox[U[d]],ee["expanded-key-"+d].push(l("cur ← "+S(U[d])+" = S-Box[cur]"))}for(var o=0;4>o;++o){var d=r+o,s=d-Z.key.length;U[d]^=U[s],g("expanded-key-"+d,"expanded-key-"+s),ee["expanded-key-"+d].push(l("old ← "+S(U[s])+" = key["+s+"]")),ee["expanded-key-"+d].push(l(S(U[d])+" = cur ⊕ old"))}}w(e("expanded-key"),U,"expanded-key-",!0)}function B(e,n,t,r,i,u){var a=o("li",r+"hdr",i),d=c(o("a"),"round "+e),s=o("span",null,["icon-expand"]);d.appendChild(s),a.appendChild(d),n.insertBefore(a,t);var l=o("li",r+"cnt",u);n.insertBefore(l,t);var p=o("div",null,["card"]),f=o("ul");return p.appendChild(f),l.appendChild(p),n.insertBefore(l,t),d.addEventListener("click",function(e){R(this,s,[l]),e.preventDefault()}),f}function E(e,n,t,r){var i=c(o("li"),e);r.appendChild(i);var u=o("li",null,["referable"]);w(u,n,t,!0),r.appendChild(u)}function D(e,n){for(var t=0;0!=e;)1&e&&(t^=n),e>>=1,n=n<<1^(128&n?27:0);return 255&t}function q(e,n,t){n[t]=[e[t][0],e[t+1][0],e[t+2][0],e[t+3][0]],n[t+1]=n[t],n[t+2]=n[t],n[t+3]=n[t]}function N(){var n=e("rounds"),t=e("rounds-end"),r=n.parentNode;s(n,t);var o=Array(Z.blockSize),i=Array(Z.blockSize),u=Array(Z.blockSize),a=Array(Z.blockSize);$.map(o,function(e,n){return u[n]=["input-"+n,"expanded-key-"+n],Z.input[n]^U[n]});var d,c;e("toggle-enc-label").classList.contains("icon-collapse")?(d=null,c=["hidden","sub"]):(d=["hidden"],c=["hidden","hidden-2","sub"]);for(var l=1;l<=Z.rounds;++l){var f="r-"+l,h=B(l,r,t,"r-enc-"+l+"-",d,c),v=f+"-sbox-";$.map(o,function(e,n){return u[n].push("sbox-"+e),_[v+n]=u[n],u[n]=[v+n],ee[v+n]=p([S(Z.sbox[e])+" = S-Box["+S(e)+"]"]),Z.sbox[e]}),E("after S-Box:",o,v,h,!0);var b=f+"-permute-";if($.map(i,function(e,n){a[n]=u[Z.permute[n]],a[n].push("permute-"+n),_[b+n]=a[n];var t=Z.permute[n];return ee[b+n]=p(["i ← "+t+" = permute["+n+"]",S(o[t])+" = block["+t+"]"]),o[t]}),E("after permutation:",i,b,h,!0),$.map(u,function(e,n){return[b+n]}),l<Z.rounds){for(var k=f+"-mult-",x=0;4>x;++x){var y=i[4*x],g=i[4*x+1],m=i[4*x+2],z=i[4*x+3],A=D(2,y),C=D(3,g),L=A^C,N=m^z;i[4*x]=L^N;var X=D(2,g),Y=D(3,m),j=y^X,I=Y^z;i[4*x+1]=j^I;var F=D(2,m),P=D(3,z),R=y^g,M=F^P;i[4*x+2]=R^M;var O=D(2,z),T=D(3,y),G=T^g,H=m^O;i[4*x+3]=G^H,q(u,a,4*x);var J=S(y),K=S(g),Q=S(m),V=S(z);ee[k+4*x]=p(["s0 ← "+S(A)+" = 2 × "+J,"s1 ← "+S(C)+" = 3 × "+K,"a ← "+S(L)+" = s0 ⊕ s1","b ← "+S(N)+" = "+Q+" ⊕ "+V,S(i[4*x])+" = a ⊕ b"]),ee[k+(4*x+1)]=p(["s1 ← "+S(X)+" = 2 × "+K,"s2 ← "+S(Y)+" = 3 × "+Q,"a ← "+S(j)+" = "+J+" ⊕ s1","b ← "+S(I)+" = s2 ⊕ "+V,S(i[4*x+1])+" = a ⊕ b"]),ee[k+(4*x+2)]=p(["s2 ← "+S(F)+" = 2 × "+Q,"s3 ← "+S(P)+" = 3 × "+V,"a ← "+S(R)+" = "+J+" ⊕ "+K,"b ← "+S(M)+" = s2 ⊕ s3",S(i[4*x+2])+" = a ⊕ b"]),ee[k+(4*x+3)]=p(["s3 ← "+S(O)+" = 2 × "+V,"s0 ← "+S(T)+" = 3 × "+J,"a ← "+S(G)+" = s0 ⊕ "+K,"b ← "+S(H)+" = "+Q+" ⊕ s3",S(i[4*x+3])+" = a ⊕ b"])}$.each(a,function(e,n){_[k+n]=e,u[n]=[k+n]}),E("after mult:",i,k,h,!0)}var W=f+"-subkey-";$.map(o,function(e,n){_[W+n]=["expanded-key-"+n];var t=Z.blockSize*l+n;return ee[W+n]=p(["bs ← "+Z.blockSize,"round ← "+l,"i ← "+n,"j ← "+t+" = bs × round + i",S(U[t])+" = key[j]"]),U[t]}),E("used subkey:",o,W,h,!0);var ne=f+"-key-";$.map(o,function(e,n){u[n].push(W+n);var t=Z.blockSize*l+n;return u[n].push("expanded-key-"+t),_[ne+n]=u[n],ee[ne+n]=p([S(i[n]^U[t])+" = "+S(i[n])+" ⊕ "+S(U[t])]),u[n]=[ne+n],i[n]^U[t]}),E("after mix with key:",o,ne,h,!0)}return w(e("output"),o,"out-",!0),$.each(u,function(e,n){_["out-"+n]=u[n]}),o}function X(n){var t=e("decode-rounds"),r=e("decode-rounds-end"),o=t.parentNode;s(t,r);var i=Array(Z.blockSize),u=Array(Z.blockSize),a=Array(Z.blockSize),d=Array(Z.blockSize),c=Array(Z.blockSize),l=Array(256);$.each(Z.permute,function(e,n){c[e]=n}),$.each(Z.sbox,function(e,n){l[e]=n}),$.map(i,function(e,t){return a[t]=["out-"+t,"expanded-key-"+(Z.rounds*Z.blockSize+t)],n[t]^U[Z.rounds*Z.blockSize+t]});var f,h;e("toggle-dec-label").classList.contains("icon-collapse")?(f=null,h=["hidden","sub"]):(f=["hidden"],h=["hidden","hidden-2","sub"]);for(var v=Z.rounds-1;v>=0;--v){var b="d-"+(v+1),k=B(v+1,o,r,"r-dec-"+(v+1)+"-",f,h),x=b+"-input-";$.map(a,function(e,n){return _[x+n]=e,ee[x+n]=p([S(i[n])+" = block["+n+"]"]),[x+n]}),E("input to round:",i,x,k,!0);var y=b+"-permute-";$.map(u,function(e,n){d[n]=a[c[n]],d[n].push("permute-"+c[n]),_[y+n]=d[n];var t=c[n];return ee[y+n]=p([n+" = permute[i]","⇒ i = "+t,S(i[t])+" = block[i]"]),i[t]}),E("after permute:",u,y,k,!0),$.map(a,function(e,n){return[y+n]});var g=b+"-sbox-";$.map(i,function(e,n){return a[n].push("sbox-"+l[u[n]]),_[g+n]=a[n],a[n]=[g+n],ee[g+n]=p([S(u[n])+" = S-Box[i]","⇒ i = "+S(l[u[n]]),"i"]),l[u[n]]}),E("after S-Box:",i,g,k,!0);var m=b+"-subkey-";$.map(u,function(e,n){_[m+n]=["expanded-key-"+n];var t=Z.blockSize*v+n;return ee[m+n]=p(["bs ← "+Z.blockSize,"round ← "+v,"i ← "+n,"j ← "+t+" = bs × round + i",S(U[t])+" = key[j]"]),U[t]}),E("used subkey:",u,m,k,!0);var z=b+"-key-";if($.map(i,function(e,n){a[n].push("expanded-key-"+(v*Z.blockSize+n)),a[n].push(m+n),_[z+n]=a[n],a[n]=[z+n];var t=v*Z.blockSize+n;return ee[z+n]=p([S(e^U[t])+" = "+S(e)+" ⊕ "+S(U[t])]),e^U[t]}),E("after mix with key:",i,z,k,!0),v>0){for(var A=b+"-mult-",C=0;C<Z.blockSize/4;++C){var L=i[4*C],N=i[4*C+1],X=i[4*C+2],Y=i[4*C+3],j=D(14,L),I=D(11,N),F=D(13,X),P=D(9,Y),R=j^I,M=F^P;i[4*C]=R^M;var O=D(9,L),T=D(14,N),G=D(11,X),H=D(13,Y),J=O^T,K=G^H;i[4*C+1]=J^K;var Q=D(13,L),V=D(9,N),W=D(14,X),ne=D(11,Y),te=Q^V,re=W^ne;i[4*C+2]=te^re;var oe=D(11,L),ie=D(13,N),ue=D(9,X),ae=D(14,Y),de=oe^ie,se=ue^ae;i[4*C+3]=de^se,q(a,d,4*C);var ce=S(L),le=S(N),pe=S(X),fe=S(Y);ee[A+4*C]=p(["s0 ← "+S(j)+" = 0x0e × "+ce,"s1 ← "+S(I)+" = 0x0b × "+le,"s2 ← "+S(F)+" = 0x0d × "+pe,"s3 ← "+S(P)+" = 0x09 × "+fe,"a ← "+S(R)+" = s0 ⊕ s1","b ← "+S(M)+" = s2 ⊕ s3",S(i[4*C])+" = a ⊕ b"]),ee[A+(4*C+1)]=p(["s0 ← "+S(O)+" = 0x09 × "+ce,"s1 ← "+S(T)+" = 0x0e × "+le,"s2 ← "+S(G)+" = 0x0b × "+pe,"s3 ← "+S(H)+" = 0x0d × "+fe,"a ← "+S(J)+" = s0 ⊕ s1","b ← "+S(K)+" = s2 ⊕ s3",S(i[4*C+1])+" = a ⊕ b"]),ee[A+(4*C+2)]=p(["s0 ← "+S(Q)+" = 0x0d × "+ce,"s1 ← "+S(V)+" = 0x09 × "+le,"s2 ← "+S(W)+" = 0x0e × "+pe,"s3 ← "+S(ne)+" = 0x0b × "+fe,"a ← "+S(te)+" = s0 ⊕ s1","b ← "+S(re)+" = s2 ⊕ s3",S(i[4*C+2])+" = a ⊕ b"]),ee[A+(4*C+3)]=p(["s0 ← "+S(oe)+" = 0x0b × "+ce,"s1 ← "+S(ie)+" = 0x0d × "+le,"s2 ← "+S(ue)+" = 0x09 × "+pe,"s3 ← "+S(ae)+" = 0x0e × "+fe,"a ← "+S(de)+" = s0 ⊕ s1","b ← "+S(se)+" = s2 ⊕ s3",S(i[4*C+3])+" = a ⊕ b"])}E("after mult:",i,A,k,!0),$.map(a,function(e,n){return _[A+n]=d[n],[A+n]})}}w(e("decoded"),i,"dec-",!0),$.each(a,function(e,n){_["dec-"+n]=e})}function Y(){x(),_={},ee={},A(),C(),L();var e=N();X(e)}function j(e){var n=0;if(e.classList.contains("hidden"))for(n=1;e.classList.contains("hidden-"+(n+1));)++n;return n}function I(e){var t=j(e);0>=t?n(e,"hidden"):n(e,"hidden-"+(t+1))}function F(e){var n=j(e);1>=n?t(e,"hidden"):t(e,"hidden-"+n)}function P(e,n){n?I(e):F(e)}function R(e,n,t){var o=n.classList.contains("icon-collapse");r(n,"icon-collapse",!o),r(n,"icon-expand",o),$.each(t,function(e){P(e,o)}),x()}function M(n,t,r){$.map(t,function(n){return e(n)}),e(n).addEventListener("click",function(n){var o=r?e(r):this.lastChild;R(this,o,t),n.preventDefault()})}function O(n,t){n.addEventListener("click",function(n){for(var r=[],o=1;o<=Z.rounds;++o)r.push(e(t+o+"-hdr")),r.push(e(t+o+"-cnt"));R(this,this.lastChild,r),n.preventDefault()})}function T(n,t){e(n).addEventListener("click",function(e){var n=Z.rounds+t;n>0&&(Z.rounds=n,Y()),e.preventDefault()})}function G(e){return e>="0"&&"9">=e||e>="a"&&"f">=e||e>="A"&&"F">=e}function H(e,n,t){var r="";$.each(n,function(e){r+=m(e)});var o=prompt(e,r);if(""!=o){for(var i=[],u=0,a=!1,d=0;d<o.length;++d)if(d<o.length&&o[d]<=" ")a&&(i.push(u),u=0,a=!1);else{if(!G(o[d]))return void alert("'"+o[d]+"' is not a valid hex digit");var s=16*u+parseInt(o[d],16);a?(i.push(s),u=0,a=!1):(u=s,a=!0)}if(a&&i.push(u),t(i,n)){for(var d=0;d<n.length;++d)n[d]=i[d];for(;n.length>i.length;)n.pop();for(var d=n.length;d<i.length;++d)n.push(i[d]);Y()}else alert("invalid byte sequence entered")}}function J(n,t,r,o){e(n).addEventListener("click",function(e){H(t,Z[r],o),e.preventDefault()})}function K(e,n){return e.length>=4}function Q(e,n){return e.length==n.length}var U,V={sbox:[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],permute:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],key:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],input:[0,17,34,51,68,85,102,119,136,153,170,187,204,221,238,255],rounds:14,blockSize:16},W=[{name:"FIPS: AES-256",key:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],rounds:14,input:[0,17,34,51,68,85,102,119,136,153,170,187,204,221,238,255],encoded:[142,162,183,202,81,103,69,191,234,252,73,144,75,73,96,137]},{name:"FIPS: AES-128",key:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],rounds:10,input:[0,17,34,51,68,85,102,119,136,153,170,187,204,221,238,255],encoded:[105,196,224,216,106,123,4,48,216,205,183,128,112,180,197,90]},{name:"FIPS: AES-192",key:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],rounds:12,input:[0,17,34,51,68,85,102,119,136,153,170,187,204,221,238,255],encoded:[221,169,124,164,134,76,223,224,110,175,112,160,236,13,113,145]}],Z={sbox:V.sbox.slice(),permute:V.permute.slice(),key:W[0].key.slice(),input:W[0].input.slice(),rounds:W[0].rounds,blockSize:V.blockSize},$={each:function(e,n){if(e&&e.length)for(var t=e.length,r=0;t>r;++r)n(e[r],r)},equals:function(e,n){if(e.length!=n.length)return!1;for(var t=0;t<e.length;++t)if(e[t]!=n[t])return!1;return!0},map:function(e,n){if(e&&e.length){for(var t=e.length,r=0;t>r;++r)e[r]=n(e[r],r);return e}}},_={},ee={},ne=null,te=!1,re=!1,oe=!1,ie=!1,ue=null;Y(),M("toggle-configuration",["testvectors-toggler","testvectors","rounds-toggler","rounds-config","sbox-toggler","sbox","permute-toggler","permute"],"conf-label"),M("toggle-rounds",["rounds-config"]),M("toggle-testvectors",["testvectors"]),M("toggle-sbox",["sbox"]),M("toggle-permute",["permute"]),M("toggle-key",["key","expanded-key-toggler","expanded-key"]),M("toggle-expanded-key",["expanded-key"]),M("toggle-input",["input"]),O(e("toggle-enc-rounds"),"r-enc-"),O(e("toggle-dec-rounds"),"r-dec-"),M("toggle-encoded",["output"]),M("toggle-reference",["reference-bytes"]),M("toggle-decoded",["decoded"]),T("inc-rounds",1),T("dec-rounds",-1),J("key","change key","key",K),J("sbox","change S-Box","sbox",Q),J("permute","change permutation","permute",Q),J("input","change input","input",Q)});</script> </body> </html>
